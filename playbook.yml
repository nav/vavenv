---

- name: Gather data about all servers and run common tasks
  hosts: all
  sudo: yes
  gather_facts: yes
  tasks:
    - debug: Gather Facts

    - name: update apt repo
      apt: update-cache=yes cache_valid_time=3600

    - name: upgrade all packages
      apt: upgrade=dist

    - name: set hostname
      hostname: name=dev

    - name: install common tools
      apt: name={{ item }} state=installed
      with_items:
        - git
        - mercurial

- name: Install roles
  hosts: all
  sudo: yes
  roles:
    - virtualenv
    - mysql
    - postgresql
    - memcache
    - rabbitmq

